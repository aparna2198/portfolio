---
---

<button
  id="theme-toggle"
  class="relative inline-flex items-center justify-center w-10 h-10 rounded-full border border-white/10 bg-white/5 hover:bg-white/10 transition-all duration-300 focus:outline-none group overflow-hidden"
  aria-label="Toggle Theme"
>
  <!-- Sun Icon -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="w-5 h-5 text-accent transition-transform duration-500 ease-spring group-hover:rotate-45 block dark:hidden"
    fill="none"
    viewBox="0 0 24 24"
    stroke="currentColor"
    id="sun-icon"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364-6.364l-.707.707M6.343 17.657l-.707.707m12.728 0l-.707-.707M6.343 6.343l-.707-.707M15 12a3 3 0 11-6 0 3 3 0 016 0z"
    />
  </svg>
  
  <!-- Moon Icon -->
  <svg
    xmlns="http://www.w3.org/2000/svg"
    class="w-5 h-5 text-accent transition-transform duration-500 ease-spring group-hover:-rotate-12 hidden dark:block"
    fill="none"
    viewBox="0 0 24 24"
    stroke="currentColor"
    id="moon-icon"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"
    />
  </svg>
</button>

<script>
  function applyTheme(theme) {
    if (theme === 'light') {
      document.documentElement.classList.add('light');
      document.documentElement.classList.remove('dark');
    } else {
      document.documentElement.classList.remove('light');
      document.documentElement.classList.add('dark');
    }
    localStorage.setItem('theme', theme);
  }

  function handleToggleClick() {
    const isLight = document.documentElement.classList.contains('light');
    applyTheme(isLight ? 'dark' : 'light');
  }

  // Setup on page load and after swaps
  function setup() {
    const themeToggle = document.getElementById('theme-toggle');
    if (themeToggle) {
      themeToggle.removeEventListener('click', handleToggleClick);
      themeToggle.addEventListener('click', handleToggleClick);
    }
  }

  setup();
  document.addEventListener('astro:after-swap', setup);
</script>

<style>
  :root.light #theme-toggle {
    border-color: rgba(0, 0, 0, 0.1);
    background-color: rgba(0, 0, 0, 0.05);
  }
  
  :root.light #theme-toggle:hover {
    background-color: rgba(0, 0, 0, 0.1);
  }

  /* Custom ease for icon rotation */
  .ease-spring {
    transition-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* Hidden/Visible utility since Tailwind simple classes might be conflictual here with dark: */
  :root.light .dark\:block { display: none !important; }
  :root.light .dark\:hidden { display: block !important; }
  :root:not(.light) .dark\:block { display: block !important; }
  :root:not(.light) .dark\:hidden { display: none !important; }
</style>
