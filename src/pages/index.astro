---
import Layout from "../layouts/Layout.astro";
import Card from "../components/Card.astro";
import LocationTile from "../components/LocationTile.astro";

// Placeholder data - To be replaced with resume content
const experience = [
  {
    role: "Software Engineer",
    company: "Morgan Stanley",
    period: "2022 - Present",
    desc: "Leading backend architecture and scaling distributed systems.",
  },
  {
    role: "Associate Software Engineer",
    company: "LogisticsNow",
    period: "2020 - 2022",
    desc: "Engineered real-time auction platforms powering transparent freight logistics.",
  },
];

const projects = [
  {
    title: "GenAI Config Assistant",
    tech: ["FastAPI", "OpenAI", "JupyterLab", "Kafka"],
    desc: "A prompt-engineered assistant using OpenAI LLMs that understands natural-language instructions and helps traders automate the creation of stock baskets.",
  },
  {
    title: "Dynamic Dashboards Platform",
    tech: ["FastAPI", "OAuth2/OIDC", "MongoDB", "Kafka", "Jenkins"],
    desc: "A low-latency backend powering real-time dashboards with secure OAuth2 auth, Kafka-based instrumentation, and full ESM observability.",
  },
  {
    title: "On-Prem ‚Üí Cloud Migration",
    tech: ["Azure AKS", "Kubernetes", "FastAPI", "OAuth2", "API Gateway"],
    desc: "A production-grade migration of compute workloads to Azure Kubernetes Service with secure API-gateway routing and autoscaling efficiency.",
  },
  {
    title: "High-Speed Data Transfer Layer",
    tech: ["gRPC", "Apache Flight", "Python", "FastAPI"],
    desc: "Replaced REST with gRPC + Apache Flight to enable high-speed columnar data transport, boosting throughput by ~60%.",
  },
  {
    title: "Real-Time Streaming & CDC Pipelines",
    tech: ["Kafka", "Flink", "Delta Lake Store"],
    desc: "Designed fault-tolerant distributed pipelines using Kafka + Flink for CDC, synchronizing systems in real-time.",
  },
  {
    title: "High-Performance Authorization Layer",
    tech: ["Redis", "FastAPI", "Python"],
    desc: "A Redis-powered write-around caching system for entitlement checks, cutting latency from ~203 ms to ~3.5 ms (‚âà58√ó improvement).",
  },
  {
    title: "Real-Time Auction Platform",
    tech: ["Azure Functions", "Cosmos DB", "Redis", "SignalR"],
    desc: "A scalable auction system using serverless compute, real-time bidding updates, caching, and Cosmos DB autoscaling.",
  },
  {
    title: "Fuel Normalization Automation",
    tech: ["Azure Functions", "Cosmos DB", "MongoDB"],
    desc: "Fully automated Excel-driven processes with Blob triggers + Cosmos DB updates, eliminating manual intervention for rate adjustments.",
  },
  {
    title: "OAuth2 Security Upgrade",
    tech: ["OAuth2", "Security", "Cloud Infra"],
    desc: "Migrated legacy Kerberos authentication to OAuth2, enforcing token-based access and strengthening cross-system data governance.",
  },
];

const skillCategories = [
  {
    title: "Languages",
    skills: [
      { name: "C++", icon: "üíª" },
      { name: "Python", icon: "üêç" },
      { name: "Ruby on Rails", icon: "üíé" },
    ],
  },
  {
    title: "Web Frameworks",
    skills: [
      { name: "FastAPI", icon: "‚ö°" },
      { name: "Gunicorn", icon: "ü¶Ñ" },
      { name: "Uvicorn", icon: "‚ú®" },
    ],
  },
  {
    title: "Cloud & Infrastructure",
    skills: [
      { name: "Azure Cloud", icon: "‚òÅÔ∏è" },
      { name: "Azure DevOps", icon: "üöÄ" },
      { name: "Docker", icon: "üê≥" },
      { name: "Flink", icon: "üêøÔ∏è" },
      { name: "GenAI", icon: "üß†" },
      { name: "Jenkins", icon: "ü§µ" },
      { name: "Kafka", icon: "üì®" },
      { name: "Kubernetes", icon: "‚ò∏Ô∏è" },
      { name: "Redis", icon: "üß†" },
      { name: "SSL/TLS", icon: "üîí" },
      { name: "Zookeeper", icon: "ü¶Å" },
    ],
  },
  {
    title: "Data Systems & Technologies",
    skills: [
      { name: "Apache Arrow", icon: "üèπ" },
      { name: "Apache Flight", icon: "‚úàÔ∏è" },
      { name: "Apache Parquet", icon: "üì¶" },
      { name: "MongoDB", icon: "üçÉ" },
      { name: "MySQL", icon: "üê¨" },
    ],
  },
  {
    title: "Authentication & Security",
    skills: [
      { name: "OAuth2", icon: "üîë" },
      { name: "OIDC", icon: "üÜî" },
      { name: "SSL/TLS", icon: "üîí" },
    ],
  },
  {
    title: "Version Control & Tools",
    skills: [
      { name: "Git", icon: "üåø" },
      { name: "Jupyter Server", icon: "ü™ê" },
      { name: "Postman", icon: "üöÄ" },
      { name: "Splunk", icon: "üîç" },
      { name: "VS Code", icon: "üìù" },
    ],
  },
];
---

<Layout title="Aparna | Portfolio">
  <!-- Hero Section -->
  <section class="mb-8 pt-10">
    <div class="grid gap-6">
      <!-- Main Status/Location Tile -->
      <LocationTile />

      <!-- Bio & CTAs -->
      <div class="reveal mt-4">
        <!-- Bio Text - Centered -->
        <div class="text-center">
          <p class="text-secondary max-w-2xl text-lg leading-relaxed mx-auto">
            I describe myself as a <span class="text-primary font-bold"
              >fanatical coder</span
            > fueled by curiosity. What began as a self-taught journey has evolved
            into 5+ years of engineering experience architecting high-performance
            backend systems, real-time platforms, and large-scale APIs, while contributing
            to open-source on GitHub and collaborating publicly across the developer
            ecosystem.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Vertical Connector -->
  <div class="flex justify-center mb-8">
    <div class="w-[1px] h-10 bg-gradient-to-b from-accent/50 to-transparent">
    </div>
  </div>

  <script>
    const updateGreeting = () => {
      const greetingEl = document.getElementById("dynamic-greeting");
      if (!greetingEl) return;

      const hour = new Date().getHours();
      let message = "Software Engineer";

      if (hour < 12) message = "Good Morning ‚òÄÔ∏è";
      else if (hour < 18) message = "Good Afternoon üëã";
      else message = "Good Evening üåô";

      greetingEl.innerText = message;
    };

    updateGreeting();
    document.addEventListener("astro:after-swap", updateGreeting);
  </script>

  <!-- Experience Section -->
  <section id="experience" class="mb-32 scroll-mt-32 reveal px-4">
    <div class="flex items-center justify-center md:justify-between mb-16">
      <h2
        class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-primary/60 text-center md:text-left"
      >
        Experience
      </h2>
      <div class="h-[1px] bg-primary/10 flex-grow ml-8 hidden md:block"></div>
    </div>

    <div class="relative max-w-4xl mx-auto">
      {/* Timeline Line */}
      <div
        class="absolute left-0 md:left-1/2 top-0 bottom-0 w-[2px] bg-gradient-to-b from-accent/50 to-transparent md:-translate-x-1/2"
      >
      </div>

      <div class="space-y-12">
        {
          experience.map((job, index) => (
            <div
              class={`relative flex flex-col md:flex-row gap-8 md:gap-0 ${index % 2 === 0 ? "md:flex-row-reverse" : ""}`}
            >
              {/* Timeline Dot */}
              <div class="absolute left-[-5px] md:left-1/2 top-0 w-3 h-3 bg-accent rounded-full md:-translate-x-1/2 mt-8 md:mt-8 shadow-[0_0_15px_rgba(34,197,94,1)] z-10 border-2 border-background">
                {index === 0 && (
                  <div class="absolute inset-0 bg-accent rounded-full animate-ping opacity-75" />
                )}
              </div>

              {/* Content Side */}
              <div class="md:w-1/2 md:px-12">
                <Card class="border-accent/20">
                  <div class="flex flex-col gap-2">
                    <span class="text-accent font-mono text-sm tracking-widest uppercase">
                      {job.period}
                    </span>
                    <h3 class="text-2xl font-bold text-primary group-hover:text-accent transition-colors">
                      {job.role}
                    </h3>
                    <p class="text-lg text-primary/80 font-medium mb-4">
                      {job.company}
                    </p>
                    <p class="text-secondary leading-relaxed">{job.desc}</p>
                  </div>
                </Card>
              </div>

              {/* Empty Side */}
              <div class="md:w-1/2" />
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Projects Section -->
  <section id="projects" class="mb-32 scroll-mt-32 reveal px-4">
    <div class="flex items-center justify-center md:justify-between mb-16">
      <h2
        class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-primary/60 text-center md:text-left"
      >
        Featured Projects
      </h2>
      <div class="h-[1px] bg-primary/10 flex-grow ml-8 hidden md:block"></div>
    </div>

    <div
      id="projects-scroll-container"
      class="flex overflow-x-auto pb-20 gap-8 px-4 no-scrollbar"
      style="scrollbar-width: none; -ms-overflow-style: none;"
    >
      {
        projects.map((project, index) => (
          <div
            class={`flex-shrink-0 w-[350px] snap-center transition-transform duration-300 ${
              index % 2 !== 0 ? "mt-16" : ""
            }`}
          >
            <Card class="h-full flex flex-col border-accent/20">
              <div class="flex justify-between items-start mb-4">
                <h3 class="text-2xl font-bold group-hover:text-accent transition-colors">
                  {project.title}
                </h3>
              </div>
              <p class="text-secondary mb-8 flex-grow leading-relaxed">
                {project.desc}
              </p>
              <div class="flex flex-wrap gap-2 mt-auto">
                {project.tech.map((t) => (
                  <span class="text-xs font-mono text-accent/80 bg-accent/5 px-3 py-1.5 rounded-lg border border-accent/10 transition-colors group-hover:border-accent/30 group-hover:bg-accent/10">
                    {t}
                  </span>
                ))}
              </div>
            </Card>
          </div>
        ))
      }
    </div>
  </section>

  <!-- Skills Section -->
  <section id="skills" class="mb-32 scroll-mt-32 reveal px-4">
    <div class="flex items-center justify-center md:justify-between mb-16">
      <h2
        class="text-4xl md:text-5xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-primary to-primary/60 text-center md:text-left"
      >
        Skills
      </h2>
      <div class="h-[1px] bg-primary/10 flex-grow ml-8 hidden md:block"></div>
    </div>
    <div class="columns-1 md:columns-2 gap-8 space-y-8">
      {
        skillCategories.map((category) => (
          <div class="break-inside-avoid mb-8">
            <h3 class="text-xl font-bold mb-4 text-primary/90 flex items-center justify-center md:justify-start gap-2">
              <span class="w-2 h-2 rounded-full bg-accent" />
              {category.title}
            </h3>
            <div class="flex flex-wrap justify-center md:justify-start gap-3">
              {category.skills.map((skill) => (
                <div class="group flex items-center gap-2 px-4 py-2.5 bg-primary/5 rounded-full border border-primary/10 hover:border-accent/40 hover:bg-accent/10 hover:shadow-[0_0_20px_rgba(34,197,94,0.2)] transition-all duration-300 cursor-default">
                  <span class="text-lg group-hover:scale-125 transition-transform duration-300">
                    {skill.icon}
                  </span>
                  <span class="text-sm font-medium text-secondary group-hover:text-primary transition-colors">
                    {skill.name}
                  </span>
                </div>
              ))}
            </div>
          </div>
        ))
      }
    </div>
  </section>

  <!-- Contact Section -->
  <section
    id="contact"
    class="mb-32 scroll-mt-32 text-center reveal relative px-4"
  >
    <div
      class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-accent/5 blur-[120px] rounded-full pointer-events-none"
    >
    </div>

    <div class="relative z-10 space-y-8">
      <div class="relative z-10 p-4">
        <p
          class="text-secondary text-xl md:text-2xl max-w-3xl mx-auto leading-relaxed relative z-20"
        >
          I‚Äôm a <span
            class="text-transparent bg-clip-text bg-gradient-to-r from-accent to-emerald-400 font-bold"
            >deeply passionate engineer</span
          > who loves <span class="text-primary font-bold"
            >solving problems</span
          >, <span class="text-primary font-bold">writing code</span> because I love
          it, <span class="text-primary font-bold">debugging</span> because I can‚Äôt
          help it, and <span class="text-primary font-bold"
            >building systems</span
          > like they matter. If you‚Äôre looking for someone who brings solid <span
            class="text-accent font-bold">self-drive</span
          >, <span class="text-accent font-bold">ownership</span>, <span
            class="text-accent font-bold">curiosity</span
          >, and <span class="text-accent font-bold">precision</span> into engineering,
          let's connect.
        </p>
      </div>
      <div class="pt-8 flex flex-col items-center gap-8">
        <a
          href="mailto:aparna.mane1998@gmail.com"
          class="inline-flex items-center gap-3 px-10 py-5 bg-primary text-background font-bold rounded-full hover:bg-accent transition-all duration-300 hover:scale-105 hover:shadow-[0_0_40px_rgba(34,197,94,0.4)]"
        >
          <span>Say Hello</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-send"
            ><path d="m22 2-7 20-4-9-9-4Z"></path><path d="M22 2 11 13"
            ></path></svg
          >
        </a>

        <div class="flex gap-8">
          <a
            href="https://github.com/aparna2198"
            target="_blank"
            rel="noopener noreferrer"
            class="text-primary font-bold text-lg hover:text-accent transition-colors tracking-tight"
            >GitHub</a
          >
          <a
            href="https://www.linkedin.com/in/aparna-rm/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-primary font-bold text-lg hover:text-accent transition-colors tracking-tight"
            >LinkedIn</a
          >
          <a
            href="/resume.pdf"
            target="_blank"
            rel="noopener noreferrer"
            class="text-primary font-bold text-lg hover:text-accent transition-colors tracking-tight flex items-center gap-2"
          >
            Resume
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-download"
            >
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7 10 12 15 17 10"></polyline>
              <line x1="12" x2="12" y1="15" y2="3"></line>
            </svg>
          </a>
        </div>
      </div>
    </div>
  </section>

  <script>
    const initProjectScroll = () => {
      const container = document.getElementById("projects-scroll-container");
      if (!container) return;

      let direction = 1; // 1 = right, -1 = left
      const speed = 0.5; // Adjust speed as needed
      let isPaused = false;
      let animationId;

      const animate = () => {
        if (!isPaused) {
          container.scrollLeft += speed * direction;

          // Check bounds with a small buffer
          if (
            container.scrollLeft + container.clientWidth >=
            container.scrollWidth - 1
          ) {
            direction = -1;
          } else if (container.scrollLeft <= 0) {
            direction = 1;
          }
        }
        animationId = requestAnimationFrame(animate);
      };

      // Events
      container.addEventListener("mouseenter", () => (isPaused = true));
      container.addEventListener("mouseleave", () => (isPaused = false));

      // Start
      animate();
    };

    initProjectScroll();
    document.addEventListener("astro:after-swap", initProjectScroll);
  </script>
</Layout>
